"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const x=require("moo");var w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function y(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var h={exports:{}};h.exports;(function(e){(function(t,i,s){function r(a){var n=this,c=d();n.next=function(){var f=2091639*n.s0+n.c*23283064365386963e-26;return n.s0=n.s1,n.s1=n.s2,n.s2=f-(n.c=f|0)},n.c=1,n.s0=c(" "),n.s1=c(" "),n.s2=c(" "),n.s0-=c(a),n.s0<0&&(n.s0+=1),n.s1-=c(a),n.s1<0&&(n.s1+=1),n.s2-=c(a),n.s2<0&&(n.s2+=1),c=null}function l(a,n){return n.c=a.c,n.s0=a.s0,n.s1=a.s1,n.s2=a.s2,n}function u(a,n){var c=new r(a),f=n&&n.state,o=c.next;return o.int32=function(){return c.next()*4294967296|0},o.double=function(){return o()+(o()*2097152|0)*11102230246251565e-32},o.quick=o,f&&(typeof f=="object"&&l(f,c),o.state=function(){return l(c,{})}),o}function d(){var a=4022871197,n=function(c){c=String(c);for(var f=0;f<c.length;f++){a+=c.charCodeAt(f);var o=.02519603282416938*a;a=o>>>0,o-=a,o*=a,a=o>>>0,o-=a,a+=o*4294967296}return(a>>>0)*23283064365386963e-26};return n}i&&i.exports?i.exports=u:this.alea=u})(w,e)})(h);var $=h.exports;const _=y($),v=x.compile({WhiteSpace:{match:/[\t\v\f\ufeff\p{Zs}]+/u,lineBreaks:!0},Lines:{match:/\r?\n|[\r\u2028\u2029]/u,lineBreaks:!0},ObjectKey:/\[?(?:\x23)?(?=[$_\p{ID_Start}\\])(?:[$_\u200C\u200D\p{ID_Continue}]|\\u[\da-fA-F]{4}|\\u\{[\da-fA-F]+\})+\]?(?=:)/u,Punctuator:/--|\+\+|=>|\.{3}|\??\.(?!\d)|(?:&&|\|\||\?\?|[+\-%&|^]|\*{1,2}|<{1,2}|>{1,3}|!=?|={1,2}|\/(?![/*]))=?|[?~,:;[\](){}]/u,BooleanLiteral:/true|false/u,NumericLiteral:/(?:0[xX][\da-fA-F](?:_?[\da-fA-F])*|0[oO][0-7](?:_?[0-7])*|0[bB][01](?:_?[01])*)n?|0n|[1-9](?:_?\d)*n|(?:(?:0(?!\d)|0\d*[89]\d*|[1-9](?:_?\d)*)(?:\.(?:\d(?:_?\d)*)?)?|\.\d(?:_?\d)*)(?:[eE][+-]?\d(?:_?\d)*)?|0[0-7]+/u,StringLiteral:{match:/(?:'(?:(?!')[^\\\n\r]|\\(?:\r\n|[^]))*')|(?:"(?:(?!")[^\\\n\r]|\\(?:\r\n|[^]))*")/u,value:e=>`"${e.slice(1,-1)}"`},Identifier:/(?:\x23)?(?=[$_\p{ID_Start}\\])(?:[$_\u200C\u200D\p{ID_Continue}]|\\u[\da-fA-F]{4}|\\u\{[\da-fA-F]+\})+/u});function A(e,t={}){const i=e.trim().replace(/[,]+$/,"");if(i==="")return"{}";if(!S(i))throw new TypeError("Unexpected input format");let s="";v.reset(i);for(const r of v)if(!(r.type==="WhiteSpace"||r.type==="Lines")){switch(r.type){case"Identifier":r.value=`"${t[r.value]||r.value}"`;break;case"ObjectKey":r.value.slice(0,1)==="["&&r.value.slice(-1)==="]"?r.value=`"${t[r.value.slice(1,-1)]||r.value.slice(1,-1)}"`:r.value=`"${r.value}"`;break}s+=r.value}return s.replace(/,([}\]])/g,"$1")}function S(e){return e.startsWith("{")&&e.endsWith("}")||e.startsWith("[")&&e.endsWith("]")}const F=/[ \t\v\f\ufeff]+/,L=/(?:(?![\s\x00\x22\x27\x3E\x2F\x3D\x00-\x1F\x7F-\x9F])[^\s\x00-\x1F\x7F-\x9F\x22\x27\x3E\x2F\x3D])+/,E=/[.#](?:(?!-?\d)(?:[a-zA-Z0-9\xA0-\uFFFF_-])+)/,D=new RegExp("(?<==)(?:true|false)"),N=new RegExp("(?<==)-?(?:(?:0[xX][\\da-fA-F](?:_?[\\da-fA-F])*|0[oO][0-7](?:_?[0-7])*|0[bB][01](?:_?[01])*)n?|-?0n|-?[1-9](?:_?\\d)*n|(?:(?:0(?!\\d)|0\\d*[89]\\d*|[1-9](?:_?\\d)*)(?:\\.(?:\\d(?:_?\\d)*)?)?|\\.\\d(?:_?\\d)*)(?:[eE][+-]?\\d(?:_?\\d)*)?|-?0[0-7]+)"),W=new RegExp(`(?<==)'(?!.*&[0-9a-zA-Z]+;)[^'\\\\]*(?:\\\\.|\\\\n[^"\\\\]*|&[^0-9a-zA-Z;]*)*'`),j=new RegExp('(?<==)"(?!.*&[0-9a-zA-Z]+;)[^"\\\\]*(?:\\\\.|\\\\n[^"\\\\]*|&[^0-9a-zA-Z;]*)*"'),C=new RegExp("(?<==)[^\"\\s'`=<>\\x00]+");function b(e){const t=typeof e=="string"&&/^(['"]).*?\1$/.test(e)?e.slice(1,-1):e;return t.startsWith("[")&&t.endsWith("]")||t.startsWith("{")&&t.endsWith("}")?JSON.parse(A(t)):t}function O(e){let t="";for(const i in e){const s=e[i];switch(typeof s){case"object":t+=` ${i}='${JSON.stringify(s)}'`;break;case"string":t+=` ${i}="${s}"`;break;case"number":case"boolean":t+=` ${i}=${s}`;break}}return t.slice(1)}const g=x.states({main:{WhiteSpace:F,AttributeShorthand:E,BooleanLiteral:{match:D,value(e){return e==="true"}},NumericLiteral:{match:N,value(e){const t=Number(e);return Number.isNaN(t)?Number(e.replace(/_|n$/g,"")):Number(e)}},SingleQuotedValue:{match:W,value:b,type:()=>"StringLiteral"},DoubleQuotedLiteral:{match:j,value:b,type:()=>"StringLiteral"},UnquotedLiteral:{match:C,value:b,type:()=>"StringLiteral"},AttributeName:L,Separator:"="}});function T(e){let t=null;const i=g.reset(e),s={};Object.defineProperties(s,{toString:{writable:!1,enumerable:!1,configurable:!1,value:()=>O(s)},getTokens:{writable:!1,enumerable:!1,configurable:!1,value:()=>Array.from(g.reset(e))}});const r=[];for(const{type:l,value:u}of i)switch(l){case"AttributeName":t=u,s[t]=t;break;case"AttributeShorthand":u[0]==="."?r.push(u.slice(1)):u[0]==="#"&&(s.id=u.slice(1));break;case"BooleanLiteral":case"NumericLiteral":case"StringLiteral":t&&(t==="class"&&r.push(u),s[t]=u,t=null);break}return r.length&&(s.class=r.join(" ")),s}const z=x.compile({spaces:/[\t\v\f\ufeff ]+/,name:/[a-zA-Z][\w-]*/,attrs:{match:/\{.*\}/,value:e=>T(e.slice(1,-1))},text:{match:/\[.*\]/,value:e=>e.slice(1,-1)},blockText:{match:/[\s\S]+/,lineBreaks:!0}});function Z(e){const{type:t,level:i,raw:s,content:r,marker:l,tag:u}=e,d=z.reset(r);let a,n,c="",f=[];for(const{type:o,value:p}of d)switch(o){case"name":a=p;break;case"attrs":n=p;break;case"text":case"blockText":c=p,f=i==="container"?this.lexer.blockTokens(p):this.lexer.inlineTokens(p);break}return{type:t,raw:s,meta:{level:i,marker:l,tag:u,name:a},attrs:n,text:c,tokens:f}}function B(e,t){switch(e){case"container":return`^${t}([\\s\\S]*?)\\n${t}`;case"block":return`^${t}((?:[a-zA-Z][\\w-]*|[\\{\\[].*?[\\}\\]])+)`;case"inline":return`^${t}((?:[a-zA-Z][\\w-]*|[\\{].*?[\\}]+|[\\[].*?[\\]])+)`}}function R(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()}function m(e){return["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"].includes(e)}function I(e){const{meta:t,attrs:i,tokens:s=[]}=e,r=t.name||t.tag;let l=`<${r}`;return l+=i?" "+i.toString():"",l+=m(r)?" />":">",l+=t.level==="container"?`
`:"",m(r)||(l+=t.level==="container"?this.parser.parse(s):this.parser.parseInline(s),l+=`</${r}>`),l+=t.level==="inline"?"":`
`,l}const k=[{level:"container",marker:":::"},{level:"block",marker:"::"},{level:"inline",marker:":"}];function P(e=k){return{extensions:e.map(({level:t,marker:i,tag:s,renderer:r})=>{const l=_(i).int32(),u=`directive${R(t)}${l}`;return{name:u,level:t==="inline"?"inline":"block",start:d=>{var a;return(a=d.match(new RegExp(i)))==null?void 0:a.index},tokenizer(d){const a=B(t,i),n=d.match(new RegExp(a));if(n){const[c,f=""]=n;return Z.call(this,{type:u,level:t,raw:c,content:f,marker:i,tag:s||(t==="inline"?"span":"div")})}},renderer:r||I}})}}exports.createDirectives=P;exports.isVoidElements=m;exports.presetDirectiveConfigs=k;
