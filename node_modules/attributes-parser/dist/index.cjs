"use strict";const c=require("moo"),u=require("json-loose"),f=/[ \t\v\f\ufeff]+/,b=/(?:(?![\s\x00\x22\x27\x3E\x2F\x3D\x00-\x1F\x7F-\x9F])[^\s\x00-\x1F\x7F-\x9F\x22\x27\x3E\x2F\x3D])+/,d=/[.#](?:(?!-?\d)(?:[a-zA-Z0-9\xA0-\uFFFF_-])+)/,m=new RegExp("(?<==)(?:true|false)"),h=new RegExp("(?<==)-?(?:(?:0[xX][\\da-fA-F](?:_?[\\da-fA-F])*|0[oO][0-7](?:_?[0-7])*|0[bB][01](?:_?[01])*)n?|-?0n|-?[1-9](?:_?\\d)*n|(?:(?:0(?!\\d)|0\\d*[89]\\d*|[1-9](?:_?\\d)*)(?:\\.(?:\\d(?:_?\\d)*)?)?|\\.\\d(?:_?\\d)*)(?:[eE][+-]?\\d(?:_?\\d)*)?|-?0[0-7]+)"),x=new RegExp(`(?<==)'(?!.*&[0-9a-zA-Z]+;)[^'\\\\]*(?:\\\\.|\\\\n[^"\\\\]*|&[^0-9a-zA-Z;]*)*'`),g=new RegExp('(?<==)"(?!.*&[0-9a-zA-Z]+;)[^"\\\\]*(?:\\\\.|\\\\n[^"\\\\]*|&[^0-9a-zA-Z;]*)*"'),L=new RegExp("(?<==)[^\"\\s'`=<>\\x00]+");function i(t){const e=typeof t=="string"&&/^(['"]).*?\1$/.test(t)?t.slice(1,-1):t;return e.startsWith("[")&&e.endsWith("]")||e.startsWith("{")&&e.endsWith("}")?JSON.parse(u(e)):e}function p(t){let e="";for(const s in t){const a=t[s];switch(typeof a){case"object":e+=` ${s}='${JSON.stringify(a)}'`;break;case"string":e+=` ${s}="${a}"`;break;case"number":case"boolean":e+=` ${s}=${a}`;break}}return e.slice(1)}const l=c.states({main:{WhiteSpace:f,AttributeShorthand:d,BooleanLiteral:{match:m,value(t){return t==="true"}},NumericLiteral:{match:h,value(t){const e=Number(t);return Number.isNaN(e)?Number(t.replace(/_|n$/g,"")):Number(t)}},SingleQuotedValue:{match:x,value:i,type:()=>"StringLiteral"},DoubleQuotedLiteral:{match:g,value:i,type:()=>"StringLiteral"},UnquotedLiteral:{match:L,value:i,type:()=>"StringLiteral"},AttributeName:b,Separator:"="}});function A(t){let e=null;const s=l.reset(t),a={};Object.defineProperties(a,{toString:{writable:!1,enumerable:!1,configurable:!1,value:()=>p(a)},getTokens:{writable:!1,enumerable:!1,configurable:!1,value:()=>Array.from(l.reset(t))}});const n=[];for(const{type:o,value:r}of s)switch(o){case"AttributeName":e=r,a[e]=e;break;case"AttributeShorthand":r[0]==="."?n.push(r.slice(1)):r[0]==="#"&&(a.id=r.slice(1));break;case"BooleanLiteral":case"NumericLiteral":case"StringLiteral":e&&(e==="class"&&n.push(r),a[e]=r,e=null);break}return n.length&&(a.class=n.join(" ")),a}module.exports=A;
